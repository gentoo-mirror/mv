# https://bugs.gentoo.org/show_bug.cgi?id=614810
# https://build.opensuse.org/package/view_file/openSUSE:Factory:ARM/wvstreams/wvstreams-openssl.patch
--- 1/crypto/wvblowfish.cc
+++ 1/crypto/wvblowfish.cc
@@ -77,7 +77,8 @@
                     // if flushing on encryption, add some randomized padding
                     size_t padlen = 8 - remainder;
                     unsigned char *pad = in.alloc(padlen);
-                    RAND_pseudo_bytes(pad, padlen);
+                    if (RAND_bytes(pad, padlen) != 1)
+                        return false;
                     len += 8;
                 }
                 else // nothing we can do here, flushing does not make sense!
--- 1/crypto/wvtripledes.cc
+++ 1/crypto/wvtripledes.cc
@@ -78,6 +78,8 @@
 		size_t padlen = 8 - remainder;
 		unsigned char *pad = in.alloc(padlen);
 		RAND_pseudo_bytes(pad, padlen);
+		if(RAND_bytes(pad, padlen) != 1)
+			return false;
 		len += 8;
 	    }
 	    else // nothing we can do here, flushing does not make sense!
